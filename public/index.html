<!DOCTYPE html>
<html>

<head>
    <title>Lab 9</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <script src="/packs/js/application-a73cc687f13e93def5bf.js" data-turbolinks-track="reload"></script>
    <script>
        seq_url = location.protocol + "//" + location.host + "/sequence/view.json"
        function send_query() {
            console.log("send query!")
            var frm = document.getElementById("seq_form");
            let input_elem = document.getElementById("values")
            console.log(input_elem.value)
            var param_str = "?values=" + input_elem.value.split(" ").join("+")
            console.log(param_str)
            if (param_str == "") return false;
            var received_data = [];
            var http_request = new XMLHttpRequest();
            http_request.open("GET", seq_url + param_str, true);
            http_request.onreadystatechange = function () {
                var done = 4, ok = 200;
                if (http_request.readyState == done &&
                    http_request.status == ok) {
                    received_data = JSON.parse(http_request.responseText);
                    show_result(received_data);
                }
            };
            http_request.send(null);
            return false;
        }
        function show_result(data) {
            // var result = document.getElementById("result");
            // result.innerHTML = "<hr/>Result is: " + data.value +
            //     "<hr/><p>" + Date() + "</p>";
            for (let i = 0; i < data.length; i++) {
                switch (data[i].name) {
                    case "result":
                    
                    break;
                    case "subs":

                    break;
                    case "error":

                    break;
                }
            }
            var p = document.createElement("p");
            p.innerText = data[0].value;
            console.log(data)
            document.body.appendChild(p);  
        }
    </script>
</head>

<body>
    <h1 class="m-3">Поиск последовательности</h1>
    <p class="m-3 text-truncate">Будет определена наиболее длинная монотонно возрастающая последовательность чисел.</p>
    <div class="w-50">
        <form class="m-3" name="seq_form" id="seq_form" accept-charset="UTF-8" method="get">
            <div class="col-12"><label for="values">Введите последовательность чисел через пробел:</label></div>
            <div class="row mt-2">
                <div class="col-11 p-1 m-0"><input type="text" name="values" id="values" value="" class="form-control"
                        required="required" /></div>
                <div class="col-1 p-1 m-0"><button type="submit" class="btn btn-primary" onclick="return send_query();">Найти</button></div>
            </div>
        </form>
    </div>
</body>

</html>